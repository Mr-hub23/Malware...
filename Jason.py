# -*- coding: utf-8 -*-
"""Advanced Malware Detection Using System Call Data 1.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1kU0uJiRurPq69uPrs0D6Tfh8b_kl-fLq
"""

# Step 1: Import Libraries
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestClassifier
from sklearn.svm import SVC
from sklearn.neural_network import MLPClassifier
from sklearn.metrics import classification_report, accuracy_score, confusion_matrix, ConfusionMatrixDisplay
import joblib

# Step 2: Load the Dataset
file_path = 'dataset.csv'  # Update with your file path
data = pd.read_csv(file_path)
print(data.head())

# Step 3: Extract and Display Dataset Information
# 3.1: Number of instances
num_instances = data.shape[0]

# 3.2: Number of features (excluding the target column)
num_features = data.shape[1] - 1  # Exclude the target column

# 3.3: Number of instances from each class
class_counts = data['classification'].value_counts()

print(f"Number of instances: {num_instances}")
print(f"Number of features: {num_features}")
print(f"Number of instances from each class:\n{class_counts}")

# 3.4: Visualize the Number of Instances from Each Class Using a Pie Chart
plt.figure(figsize=(8, 8))
class_counts.plot.pie(autopct='%1.1f%%', startangle=90, colors=['#ff9999','#66b3ff'])
plt.title('Class Distribution: Malware vs Benign')
plt.ylabel('')  # Hides the y-label
plt.show()